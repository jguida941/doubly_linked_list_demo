#!/usr/bin/env bash
set -Eeuo pipefail
APP_DIR="$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")/.." && pwd)"   # .../Contents
REPO_ROOT="$(cd -- "$APP_DIR/../../.." && pwd)"                     # repo root

# Attempt to bootstrap permissions/quarantine silently (best effort)
if [[ -f "$REPO_ROOT/scripts/bootstrap_mac.command" ]]; then
  bash "$REPO_ROOT/scripts/bootstrap_mac.command" >/dev/null 2>&1 || true
fi

# Launch Terminal and run the educational demo script
SCRIPT_PATH="$REPO_ROOT/scripts/Run_Educational_Demo.command"
OSA_SCRIPT=$(cat <<'APL'
on run argv
  set thePath to item 1 of argv
  tell application "Terminal"
    activate
    do script "bash \"" & thePath & "\""
  end tell
end run
APL
)
/usr/bin/osascript - "$SCRIPT_PATH" <<<"$OSA_SCRIPT" 2>/dev/null || /bin/bash "$SCRIPT_PATH"
